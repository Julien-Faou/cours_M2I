# Méthodologie template - Pentest
### Auteur : Julien Faou
#### Basé sur l'ISSAF

# Information gathering
## GOAL
* Employees (name and number of employees, role, positions and contact details,)
* Technology partners (technologies used, locations, computing platforms)
* Business partners (involvement, location, their trust relationship, and so on)
* Business/financial history, investments, and investor details
* Web presence (name and number of domains, where they are hosted, etc.)
* Physical locations (offices, data centers, partners, warehouses)
* Network topology and -architecture
* Technologies being implemented on the network
* E-mails, phone numbers, or any other personal information
* Company location, product names, and names of senior managers in the company
* IP block owned
* Administration and maintenance contact for target domain and IP block

## Passive information gathering
* Locate the target Web presence
* Examine the target using search engines
* Search Web groups
* Search employee personal Web sites
* Search Security & Exchange Commission and finance sites
* Search uptime statistics sites
* Search system/network survey sites
* Search on P2P networks
* Search on Internet Relay Chat (IRC)
* Search job databases
* Search newsgroups (NNTP)
* Gain information from domain registrar
    * Check for reverse DNS lookup presence
    * Check more DNS information
    * Check Spam database lookup
    * Check to change WHOIS information

## Active information gathering
* Emails systems - User Account enumeration
* SMTP Headers Analysis - Email received from target
* SMTP Headers Analysis – Bounced E-mail
* SMTP Headers Analysis – Read Receipt
* Perform BGP (Border Gateway Protocol) Query
* DNS Interrogation - Perform Zone Transfer on Primary, Secondary and ISP name server
* DNS Interrogation - Perform Zone Transfer by dictionary attack
* DNS INTEROGATION - Finding IPv6 IP blocks in use though DNS queries
* Mirror Target Web Site
* Global Countermeasures

# Network mapping
* Find live hosts
* ARP discovery

##  Port and service scanning 
* Determine running services
* Find open ports
    * TCP port scanning
    * UDP port scanning
    * Banner grabbing - fingerprinting

## Perimeter network mapping (router, firewalls)
* Tracerouting
* Scan default firewall / router ports
* Perform FIN/ACK scan
* Map router / Firewall rule-base

## Operating system fingerprinting
### Passive OS guessing
* Snifing and analyse

### Active OS guessing
* Using TCP/IP stack fingerprinting
* Using HTTP packet analysis
* Using ICMP packet analysis
* Using TELNET handshake analysis
* Banner grabbing analysis


* Identifing cirtical services
* Operating fingerprinting
* Identifying routes using Management Information Base (MIB)
* Service fingerprinting

## Perform war-dialing 
* 

## Host enumeration
* Systems enumerations


# Vulnerability identification
* Identify vulnerable services using service banners
* Perform vulnerability scan to search for known vulnerabilities. Information regarding known vulnerabilities can be obtained from the vendors’ security announcements, or from public databases such as SecurityFocus, CVE or CERT advisories.
* Perform false positive and false negative verification (e.g. by correlating vulnerabilities with each other and with previously acquired information)
* Enumerate discovered vulnerabilities
* Estimate probable impact (classify vulnerabilities found)
* Identify attack paths and scenarios for exploitation

# Penetration
* Find proof of concept code/tool
* Develop tools/scripts
* Test proof of concept code/tool
* Use proof of concept code against target
* Verify or disprove the existence of vulnerabilities

# Gaining access & Privilege escalation
## Gaining access
### Gain Privilege
* Discovery of username/password combinations (e.g. dictionary attacks, brute force attacks)
* Discovery of blank password or default passwords in system accounts
* Exploit vendor default settings (such as network configuration parameters, passwords and others)
* Discovery of public services that allow for certain operations within the system (e.g. writing/creating/reading files)

# Enumerating Further
* Obtain encrypted passwords for offline cracking (for example by dumping the SAM on Windows systems, or copying /etc/passwd and /etc/shadow from a Linux system)
* Obtain password (plaintext or encrypted) by using sniffing or other techniques
* Sniff traffic and analyze it
* Gather cookies and use them to exploit sessions and for password attacks
* E-mail address gathering
* Identifying routes and networks
* Mapping internal networks
* Perform steps 1 to 6 again with this system as starting point


# Compromise remote users / sites
* Try to get remote access to other networks, sites
    => Follow again all steps

# Maintaining access
## Covert channels
* Identify Covert Channel Which Can Be Used
* Select the Best Available Tool for the Covert Channel
* Methodology - Setup the Covert Channel in the Target Network
* Test the Covertness of Channel Using Common Detection Technique

## Backdoors
* Setting up backdoors

## Root-Kits
* Setting up Root-kits 

# Covering tracks
## Hide files
* Hide files
### Unix
* Rename file
* Hide file using root-kits

### Windows
* Hide the files/directories with attribute +S+H
* Hide the files with file streaming on NTFS
* Putting files into un-accessible directories
* Putting files into "special windows" directories

## Clear logs
### windows
* Event viewer logs
* Web server log
* Terminal Service log

### Unix
* Check history
* Edit log files

## Defeat integrity checking
* Look for integrity checking and try to defeat it (file whiti signature, misconfiguration, ...)

## Defeat anti-virus
* Disable the AV services
* Block the central management port


# Password security testing
## First part : Gathering authentification credentials

### Process
* determine the different uses of passwords in the remote system for authentication and /or authorization purposes
* determine if encryption is in use
* determine encryption algorithm used
* obtaining the plaintext password, encrypted password or hashes (depending on points 2 and 3 above, if no encryption is used the process ends here)
* choose of the proper password analysis tool (password cracker)
* attack of the encrypted password or hash with the proper method, depending on methods available on the tool and maximum time available for the cracking

## Second part : Encrypted/hashed password cracking
### Password type
* Clear text
* Obfuscated Password
* Encrypted password
* Hashed password
* Salt

### Algorithm
* Fidnd algorithm used


# IDS





IDS
FIREWALL
ANTIVIRUS

p483 linux
p607-699 web